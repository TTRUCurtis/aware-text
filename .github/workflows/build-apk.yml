name: Build Android App

on:
  push:
  # Need to figure out how to block direct pushes to these branches
    branches:
      - main
      - pre-release
  pull_request:
    branches:
      - main
      - pre-release

jobs:
#   build:

#     runs-on: ubuntu-latest

#     steps:
#     - name: Checkout repository
#       uses: actions/checkout@v3
#     - name: set up JDK 11
#       uses: actions/setup-java@v3
#       with:
#         java-version: '11'
#         distribution: 'temurin'
#         cache: gradle

#     - name: Grant execute permission for gradlew
#       run: chmod +x gradlew
# #     - name: Build Android App
# #       uses: sparkfabrik/android-build-action@v1.2.0
# #       with:
# #         project-path: .
# #         output-path: AwareD.apk
#     - name: Android Build
#       uses: vgaidarji/android-github-actions-build@v1.0.1
#       with:
#         args: "./gradlew assembleDebug"
  apk:
    name: Generate APK
#     needs: test
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Setup JDK
        uses: actions/setup-java@v3
        with:
          java-version: '11'
          distribution: 'temurin'
          cache: gradle
      - name: Build APK
        run: bash ./gradlew assembleDebug --stacktrace
      - name: Upload APK
        uses: actions/upload-artifact@v3
        with:
          name: apk
          path: app/build/outputs/apk/debug/aware-debug.apk
